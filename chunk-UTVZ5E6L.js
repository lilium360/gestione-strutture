import{a as H}from"./chunk-U2TOJW7X.js";import{a as N}from"./chunk-C2AJT47N.js";import{a as J,b as K,c as Q}from"./chunk-AOWNFRET.js";import{e as O,f as v,g as V,h as A,i as L,j as z,k as q,l as G,m as $,n as j,o as B,p as R,q as W,r as U,t as Y}from"./chunk-XVVISF6R.js";import{A as b,D as l,Ea as T,G as I,K as f,N as m,O as C,P as _,Q as E,R as F,S as x,T as a,U as t,V as g,W as S,X as d,Y as s,da as r,ea as y,fa as k,ib as M,jb as D,qa as w,r as h,ra as P,u as p,v as u}from"./chunk-J337Y4CE.js";import"./chunk-FDERIQAA.js";var ee=(o,i)=>i.id,te=(o,i)=>i.value;function ie(o,i){o&1&&(a(0,"span",8),r(1,"Name is required"),t())}function ne(o,i){if(o&1&&(a(0,"option",13),r(1),t()),o&2){let e=i.$implicit,n=s();m("value",e),l(),y(n.getTypeLabel(e))}}function ae(o,i){o&1&&(a(0,"span",8),r(1,"Type is required"),t())}function oe(o,i){if(o&1){let e=S();a(0,"label",20)(1,"input",30),d("change",function(){let c=p(e).$implicit,Z=s();return u(Z.toggleFeature(c.id))}),t(),a(2,"span",31),r(3),t()()}if(o&2){let e=i.$implicit,n=s();l(),m("checked",n.isFeatureSelected(e.id)),l(2),y(e.name)}}function re(o,i){o&1&&(a(0,"p",23),r(1,'No features available. Click "Add New" to create one.'),t())}function le(o,i){o&1&&(a(0,"span",8),r(1,"Name is required"),t())}function ce(o,i){if(o&1&&(a(0,"option",13),r(1),t()),o&2){let e=i.$implicit,n=s(2);m("value",e),l(),y(n.getFeatureCategoryLabel(e))}}function se(o,i){o&1&&(a(0,"span",8),r(1,"Category is required"),t())}function de(o,i){if(o&1&&(a(0,"option",13),r(1),t()),o&2){let e=i.$implicit;m("value",e.value),l(),y(e.label)}}function me(o,i){o&1&&(a(0,"span",8),r(1,"Icon is required"),t())}function pe(o,i){o&1&&(g(0,"span",50),r(1," Creating... "))}function ue(o,i){o&1&&r(0," Create Feature ")}function fe(o,i){if(o&1){let e=S();a(0,"div",32),d("click",function(){p(e);let c=s();return u(c.closeAddFeaturePanel())}),t(),a(1,"div",33)(2,"div",34)(3,"h3",35),r(4,"Add New Feature"),t(),a(5,"button",36),d("click",function(){p(e);let c=s();return u(c.closeAddFeaturePanel())}),g(6,"lucide-icon",37),t()(),a(7,"div",38)(8,"form",39),d("ngSubmit",function(){p(e);let c=s();return u(c.onCreateFeature())}),a(9,"div",5)(10,"label",40),r(11,"Name *"),t(),g(12,"input",41),f(13,le,2,0,"span",8),t(),a(14,"div",5)(15,"label",42),r(16,"Category *"),t(),a(17,"select",43)(18,"option",12),r(19,"Select a category"),t(),F(20,ce,2,2,"option",13,E),t(),f(22,se,2,0,"span",8),t(),a(23,"div",5)(24,"label",44),r(25,"Icon *"),t(),a(26,"select",45)(27,"option",12),r(28,"Select an icon"),t(),F(29,de,2,2,"option",13,te),t(),f(31,me,2,0,"span",8),t(),a(32,"div",5)(33,"label",46),r(34,"Description"),t(),g(35,"textarea",47),t()()(),a(36,"div",48)(37,"button",27),d("click",function(){p(e);let c=s();return u(c.closeAddFeaturePanel())}),r(38,"Cancel"),t(),a(39,"button",49),d("click",function(){p(e);let c=s();return u(c.onCreateFeature())}),f(40,pe,2,0)(41,ue,1,0),t()()()}if(o&2){let e=s();C("closing",e.isClosingPanel()),l(),C("closing",e.isClosingPanel()),l(5),m("size",20),l(2),m("formGroup",e.featureForm),l(4),C("error",e.isFeatureFieldInvalid("name")),l(),_(e.isFeatureFieldInvalid("name")?13:-1),l(4),C("error",e.isFeatureFieldInvalid("category")),l(3),x(e.featureCategories),l(2),_(e.isFeatureFieldInvalid("category")?22:-1),l(4),C("error",e.isFeatureFieldInvalid("icon")),l(3),x(e.featureIcons),l(2),_(e.isFeatureFieldInvalid("icon")?31:-1),l(8),m("disabled",e.featureForm.invalid||e.isCreatingFeature()),l(),_(e.isCreatingFeature()?40:41)}}function _e(o,i){if(o&1){let e=S();a(0,"button",51),d("click",function(){p(e);let c=s();return u(c.confirmDelete())}),g(1,"lucide-icon",52),r(2," Delete "),t()}o&2&&(l(),m("size",16))}function ge(o,i){o&1&&(g(0,"span",50),r(1," Saving... "))}function ve(o,i){if(o&1&&r(0),o&2){let e=s();k(" ",e.isEditMode?"Update Space":"Create Space"," ")}}function Ce(o,i){if(o&1){let e=S();a(0,"div",53),d("click",function(){p(e);let c=s();return u(c.onDeleteCancel())}),a(1,"div",54),d("click",function(c){return p(e),u(c.stopPropagation())}),a(2,"h3",55),r(3,"Delete Space"),t(),a(4,"p",56),r(5,"Are you sure you want to delete this space? This action cannot be undone."),t(),a(6,"div",57)(7,"button",27),d("click",function(){p(e);let c=s();return u(c.onDeleteCancel())}),r(8,"Cancel"),t(),a(9,"button",51),d("click",function(){p(e);let c=s();return u(c.onDeleteConfirm())}),r(10,"Delete"),t()()()()}}var X=class o{structureId;spaceId;fb=h(W);router=h(T);spacesFacade=h(H);featuresFacade=h(J);structuresFacade=h(N);location=h(w);form;featureForm;isSubmitting=!1;showDeleteDialog=!1;selectedFeatureIds=[];structureName=b("");allFeatures=b([]);showAddFeaturePanel=b(!1);isClosingPanel=b(!1);isCreatingFeature=b(!1);spaceTypes=["meeting_room","office","bathroom","common_area","storage","kitchen"];featureCategories=["connectivity","equipment","accessibility","comfort"];featureIcons=[{value:"wifi",label:"Wi-Fi"},{value:"presentation",label:"Projector"},{value:"accessibility",label:"Accessibility"},{value:"thermometer",label:"Climate Control"},{value:"video",label:"Video Conference"},{value:"square",label:"Whiteboard"},{value:"cable",label:"Ethernet"},{value:"sun",label:"Natural Light"}];get isEditMode(){return!!this.spaceId}goBack(){this.location.back()}confirmDelete(){this.showDeleteDialog=!0}onDeleteCancel(){this.showDeleteDialog=!1}onDeleteConfirm(){this.spaceId&&this.spacesFacade.deleteSpace(this.spaceId).subscribe(()=>{this.router.navigate(["/structures",this.structureId])}),this.showDeleteDialog=!1}openAddFeaturePanel(){this.initFeatureForm(),this.showAddFeaturePanel.set(!0)}closeAddFeaturePanel(){this.isClosingPanel()||(this.isClosingPanel.set(!0),setTimeout(()=>{this.showAddFeaturePanel.set(!1),this.isClosingPanel.set(!1)},200))}getFeatureCategoryLabel(i){return Q[i]}isFeatureFieldInvalid(i){let e=this.featureForm.get(i);return!!(e&&e.invalid&&e.touched)}onCreateFeature(){if(this.featureForm.invalid){this.featureForm.markAllAsTouched();return}this.isCreatingFeature.set(!0);let i=this.featureForm.value;this.featuresFacade.createFeature(i).subscribe({next:e=>{this.allFeatures.update(n=>[...n,e]),this.selectedFeatureIds.push(e.id),this.isCreatingFeature.set(!1),this.closeAddFeaturePanel()},error:()=>{this.isCreatingFeature.set(!1)}})}initFeatureForm(){this.featureForm=this.fb.group({name:["",[v.required,v.minLength(2)]],category:["",v.required],icon:["",v.required],description:[""]})}ngOnInit(){this.initForm(),this.initFeatureForm(),this.loadData()}initForm(){this.form=this.fb.group({name:["",[v.required,v.minLength(2)]],type:["",v.required],floor:[null],capacity:[null,[v.min(1)]]})}loadData(){this.structuresFacade.loadStructure(this.structureId),this.featuresFacade.loadFeatures();let i=setInterval(()=>{let n=this.structuresFacade.selectedStructure();n&&n.id===this.structureId&&(this.structureName.set(n.name),clearInterval(i))},100),e=setInterval(()=>{let n=this.featuresFacade.features();(n.length>0||!this.featuresFacade.loading())&&(this.allFeatures.set(n),clearInterval(e))},100);this.isEditMode&&this.loadSpace()}loadSpace(){this.spacesFacade.loadSpace(this.spaceId);let i=setInterval(()=>{let e=this.spacesFacade.selectedSpace();e&&e.id===this.spaceId&&(this.form.patchValue({name:e.name,type:e.type,floor:e.floor,capacity:e.capacity}),this.selectedFeatureIds=[...e.featureIds],clearInterval(i))},100)}getTypeLabel(i){return K[i]}isFieldInvalid(i){let e=this.form.get(i);return!!(e&&e.invalid&&e.touched)}isFeatureSelected(i){return this.selectedFeatureIds.includes(i)}toggleFeature(i){let e=this.selectedFeatureIds.indexOf(i);e>-1?this.selectedFeatureIds.splice(e,1):this.selectedFeatureIds.push(i)}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.isSubmitting=!0;let i=this.form.value,e={name:i.name,type:i.type,structureId:this.structureId,floor:i.floor,capacity:i.capacity,featureIds:this.selectedFeatureIds};(this.isEditMode?this.spacesFacade.updateSpace(this.spaceId,e):this.spacesFacade.createSpace(e)).subscribe({next:()=>{this.router.navigate(["/structures",this.structureId])},error:()=>{this.isSubmitting=!1}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=I({type:o,selectors:[["app-space-form"]],inputs:{structureId:"structureId",spaceId:"spaceId"},decls:52,vars:16,consts:[[1,"page-container"],[3,"title","subtitle"],[1,"form-layout-narrow",3,"ngSubmit","formGroup"],[1,"form-card"],[1,"form-section-title"],[1,"form-group"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","placeholder","e.g., Conference Room A",1,"form-input"],[1,"form-error"],[1,"form-row"],["for","type",1,"form-label"],["id","type","formControlName","type",1,"form-input","form-select"],["value",""],[3,"value"],["for","floor",1,"form-label"],["type","number","id","floor","formControlName","floor","placeholder","e.g., 1",1,"form-input"],["for","capacity",1,"form-label"],["type","number","id","capacity","formControlName","capacity","min","1","placeholder","Number of people",1,"form-input"],[1,"form-hint-text"],[1,"features-grid"],[1,"feature-checkbox"],["type","button",1,"add-feature-btn",3,"click"],["name","plus",3,"size"],[1,"no-features"],[1,"form-actions"],["type","button",1,"btn","btn-danger"],[1,"form-actions-right"],["type","button",1,"btn","btn-outline",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"dialog-overlay"],["type","checkbox",3,"change","checked"],[1,"checkbox-label"],[1,"offcanvas-overlay",3,"click"],[1,"offcanvas-panel"],[1,"offcanvas-header"],[1,"offcanvas-title"],["type","button",1,"offcanvas-close",3,"click"],["name","x",3,"size"],[1,"offcanvas-body"],[3,"ngSubmit","formGroup"],["for","featureName",1,"form-label"],["type","text","id","featureName","formControlName","name","placeholder","e.g., Wi-Fi, Projector",1,"form-input"],["for","featureCategory",1,"form-label"],["id","featureCategory","formControlName","category",1,"form-input","form-select"],["for","featureIcon",1,"form-label"],["id","featureIcon","formControlName","icon",1,"form-input","form-select"],["for","featureDescription",1,"form-label"],["id","featureDescription","formControlName","description","rows","2","placeholder","Optional description",1,"form-input","form-textarea"],[1,"offcanvas-footer"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"spinner"],["type","button",1,"btn","btn-danger",3,"click"],["name","trash-2",3,"size"],[1,"dialog-overlay",3,"click"],[1,"dialog-content",3,"click"],[1,"dialog-title"],[1,"dialog-message"],[1,"dialog-actions"]],template:function(e,n){e&1&&(a(0,"div",0),g(1,"app-page-header",1),a(2,"form",2),d("ngSubmit",function(){return n.onSubmit()}),a(3,"div",3)(4,"h3",4),r(5,"Space Information"),t(),a(6,"div",5)(7,"label",6),r(8,"Name *"),t(),g(9,"input",7),f(10,ie,2,0,"span",8),t(),a(11,"div",9)(12,"div",5)(13,"label",10),r(14,"Type *"),t(),a(15,"select",11)(16,"option",12),r(17,"Select a type"),t(),F(18,ne,2,2,"option",13,E),t(),f(20,ae,2,0,"span",8),t(),a(21,"div",5)(22,"label",14),r(23,"Floor"),t(),g(24,"input",15),t()(),a(25,"div",5)(26,"label",16),r(27,"Capacity"),t(),g(28,"input",17),t()(),a(29,"div",3)(30,"h3",4),r(31,"Features"),t(),a(32,"p",18),r(33,"Select the amenities available in this space"),t(),a(34,"div",19),F(35,oe,4,2,"label",20,ee),a(37,"button",21),d("click",function(){return n.openAddFeaturePanel()}),g(38,"lucide-icon",22),a(39,"span"),r(40,"Add New"),t()()(),f(41,re,2,0,"p",23),t(),f(42,fe,42,17),a(43,"div",24),f(44,_e,3,1,"button",25),a(45,"div",26)(46,"button",27),d("click",function(){return n.goBack()}),r(47,"Cancel"),t(),a(48,"button",28),f(49,ge,2,0)(50,ve,1,1),t()()()(),f(51,Ce,11,0,"div",29),t()),e&2&&(l(),m("title",n.isEditMode?"Edit Space":"New Space")("subtitle",n.structureName()?"for "+n.structureName():""),l(),m("formGroup",n.form),l(7),C("error",n.isFieldInvalid("name")),l(),_(n.isFieldInvalid("name")?10:-1),l(5),C("error",n.isFieldInvalid("type")),l(3),x(n.spaceTypes),l(2),_(n.isFieldInvalid("type")?20:-1),l(15),x(n.allFeatures()),l(3),m("size",18),l(3),_(n.allFeatures().length===0?41:-1),l(),_(n.showAddFeaturePanel()?42:-1),l(2),_(n.isEditMode?44:-1),l(4),m("disabled",n.form.invalid||n.isSubmitting),l(),_(n.isSubmitting?49:50),l(2),_(n.showDeleteDialog?51:-1))},dependencies:[P,U,L,j,B,O,z,$,V,A,R,q,G,D,M,Y],styles:[".features-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}.feature-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px;background:hsl(var(--background));border:1px solid hsl(var(--border));border-radius:var(--radius);cursor:pointer;transition:all .15s ease}.feature-checkbox[_ngcontent-%COMP%]:hover{border-color:hsl(var(--ring))}.feature-checkbox[_ngcontent-%COMP%]:has(input:checked){border-color:hsl(var(--primary));background:hsl(var(--primary)/.1)}.feature-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px;accent-color:hsl(var(--primary))}.checkbox-label[_ngcontent-%COMP%]{font-size:14px;color:hsl(var(--foreground))}.no-features[_ngcontent-%COMP%]{font-size:14px;color:hsl(var(--muted-foreground));text-align:center;padding:24px}.add-feature-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;gap:10px;padding:12px;background:transparent;border:2px dashed hsl(var(--border));border-radius:var(--radius);color:hsl(var(--muted-foreground));cursor:pointer;transition:all .15s ease}.add-feature-btn[_ngcontent-%COMP%]:hover{border-color:hsl(var(--primary));color:hsl(var(--primary));background:hsl(var(--primary)/.05)}.add-feature-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500}@media (max-width: 640px){.add-feature-btn[_ngcontent-%COMP%]{flex-direction:column;gap:6px;padding:16px 12px}.add-feature-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}}.offcanvas-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000;animation:fadeIn .2s ease}.offcanvas-overlay.closing[_ngcontent-%COMP%]{animation:fadeOut .2s ease forwards}.offcanvas-panel[_ngcontent-%COMP%]{position:fixed;top:0;right:0;bottom:0;width:400px;max-width:100%;background:hsl(var(--card));z-index:1001;display:flex;flex-direction:column;animation:slideIn .2s ease}.offcanvas-panel.closing[_ngcontent-%COMP%]{animation:slideOut .2s ease forwards}.offcanvas-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid hsl(var(--border))}.offcanvas-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:hsl(var(--card-foreground));margin:0}.offcanvas-close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:transparent;border:none;border-radius:var(--radius);color:hsl(var(--muted-foreground));cursor:pointer;transition:all .15s ease}.offcanvas-close[_ngcontent-%COMP%]:hover{background:hsl(var(--accent));color:hsl(var(--foreground))}.offcanvas-body[_ngcontent-%COMP%]{flex:1;padding:20px;overflow-y:auto}.offcanvas-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid hsl(var(--border))}"],changeDetection:0})};export{X as SpaceFormComponent};
